using advent_of_code.Day_3;
using System.Collections;

namespace advent_of_code_tests.Day_3
{
    public class EngineSchematicGenerator : IEnumerable<object[]>
    {
        private readonly List<object[]> _data =
        [
            [
                new List<string>
                {
                    "467..114..",
                    "...*......",
                    "..35..633.",
                    "......#...",
                    "617*......",
                    ".....+.58.",
                    "..592.....",
                    "......755.",
                    "...$.*....",
                    ".664.598.."
                },
                4361
            ],
            [
                new List<string>
                {
                    "....%..562............*.....@...........*..528.......321...........*673......................887..%231...............700..............116...",
                    ".988..=....944...596........806...24..519./..........*......../...............146...........*...................554..*......................",
                    "..........$.......................................822...621..771..151.504.......*.628*343..34...+.&..............*..329.303..641..678..+...."
                },
                10786
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666.",
                    "....."
                },
                0
            ],
            [
                new List<string>
                {
                    "$....",
                    ".666.",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    ".*...",
                    ".666.",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    "..=..",
                    ".666.",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    "...\\.",
                    ".666.",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    "..../",
                    ".666.",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    "%666.",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666-",
                    "....."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666.",
                    "+...."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666.",
                    ".%..."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666.",
                    "..*.."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666.",
                    "...*."
                },
                666
            ],
            [
                new List<string>
                {
                    ".....",
                    ".666.",
                    "....*"
                },
                666
            ],
            [
                new List<string>
                {
                    "...399.......#..=.........",
                    ".....*.....856..809..450..",
                    "..501..224........../....."
                },
                3015
            ],
            [
                new List<string>
                {
                    ".....612..........*.612..291..592..",
                    "................24.....*...........",
                    "...........303.........605..326....",
                    "......484=..=.....753..........$...",
                    "...-...............*.........*.....",
                    "....825............603....544.634.."
                },
                5713
            ],
            [
                new List<string>
                {
                    ".988..=....944...596........806...24..519./..........*......../..............",
                    "..........$.......................................822...621..771..151.504....",
                    "........................361.....347*524..538...........*.........*.....-.....",
                    ".716..517...+..........*................*......955$..544.....238..593.....399",
                    "...%.+.......744....550..........#131....964.............234..*.............*",
                    "........264...............798......................816....%....228.......501."
                },
                12897
            ],
            [
                new List<string>
                {
                    ".....612..........*.612..291..592...",
                    "................24.....*............",
                    "...........303.........605..326.....",
                    "......484=..=.....753..........$....",
                    "...-...............*.........*......",
                    "....825............603....544.634...",
                    "........755.........................",
                    "....323.........221..............892"
                }, 5713
            ],
            [
                new List<string>
                {
                    ".........",
                    ".666.666.",
                    "........."
                },
                0
            ],
            [
                new List<string>
                {
                    ".......*.",
                    ".666.666.",
                    "........."
                },
                666
            ],
            [
                new List<string>
                {
                    ".......*.",
                    ".666.666.",
                },
                666
            ],
            [
                new List<string>
                {
                    "..*......",
                    ".666.666.",
                },
                666
            ],
            [
                new List<string>
                {
                    ".666.666.",
                    "..*......",
                },
                666
            ],
            [
                new List<string>
                {
                    ".666.666.",
                    ".......+.",
                },
                666
            ],
        ];

        public IEnumerator<object[]> GetEnumerator() => _data.GetEnumerator();

        IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();
    }

    public class EngineSchematicTest
    {
        [Theory]
        [ClassData(typeof(EngineSchematicGenerator))]
        public void Sum_ReturnsTotalOfAllNumbers(List<string> data, int expected)
        {
            var engineSchematic = new EngineSchematic(data);

            Assert.Equal(expected, engineSchematic.Sum);
        }

        [Fact]
        public void GetGearRatios_ReturnsAllPartNumbers()
        {
            var input = new List<string>
                {
                    "467..114..",
                    "...*......",
                    "..35..633.",
                    "......#...",
                    "617*......",
                    ".....+.58.",
                    "..592.....",
                    "..........",
                    "....2*5...",
                    "..........",
                    "......755.",
                    "...$.*....",
                    ".664.598.."
                };

            var engineSchematic = new EngineSchematic(input);

            int[] expected = [(467 * 35), (2 * 5), (755 * 598)];
            Assert.Equal(expected, engineSchematic.GearRatios);
        }
    }
}
